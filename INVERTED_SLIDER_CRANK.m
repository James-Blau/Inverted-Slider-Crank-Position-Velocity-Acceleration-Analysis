%%ENTER INPUTS FOR LENGTHS, GAMMA ANGLE, CRANK ANGLE, VELOCITY, ACCELERATION
prompt = {'What is the length of link 1?', 'What is the length of link 2?',...
    'What is the length of link 4?', 'What is the value of gamma?', ...
    'What is the value of theta 2?', 'What is the value of omega 2?', ...
    'What is the value of alpha 2?'};
title = 'Input';
dims =[1 35];
def = {'','','','','','',''};
answer= inputdlg(prompt,title,dims,def);
d = str2double(answer(1));
a = str2double(answer(2));
c = str2double(answer(3));
y = str2double(answer(4));
T2 = str2double(answer(5));
w2 = str2double(answer(6));
a2 = str2double(answer(7));

P = a*sind(T2)*sind(y) + (a*cosd(T2) - d)*cosd(y);
Q = -a*sind(T2)*cosd(y) + (a*cosd(T2) - d)*sind(y);
R = -c*sind(y);
S = R - Q;
T = 2*P;
U = Q + R;
T41 = 2*atand((-T + sqrt(T^2 - 4*S*U))/(2*S));
T42 = 2*atand((-T - sqrt(T^2 - 4*S*U))/(2*S));
T31 = T41 + y;
T32 = T42 + y + 180;
b1 = (a*sind(T2)-c*sind(T41))/(sind(T31));
b2 = (a*sind(T2)-c*sind(T42))/(sind(T32));
w41 = (a*w2*cosd(T2-T31))/(b1 + c*cosd(T41-T31));
w42 = (a*w2*cosd(T2-T32))/(b2 + c*cosd(T42-T32));
Va = a*w2*(-sind(T2) + 1i*cosd(T2));
Vam = abs(Va);
TVa = radtodeg(angle(Va));
VB41 = c*w41*(-sind(T41) + 1i*cosd(T41));
VB41m = abs(VB41);
TVb41 = radtodeg(angle(VB41));
VB42 = c*w42*(-sind(T42) + 1i*cosd(T42));
VB42m = abs(VB42);
TVb42 = radtodeg(angle(VB42));
Vs1 = (-a*w2*sind(T2) + w41*(b1*sind(T31) + c*sind(T41)))/cosd(T31);
Vs2 = (-a*w2*sind(T2) + w42*(b2*sind(T32) + c*sind(T42)))/cosd(T32);
F1 = a*a2*cosd(T31-T2);
F2 = a*a2*cosd(T32-T2);
G1 = a*w2^2*sind(T31-T2);
G2 = a*w2^2*sind(T32-T2);
H1 = c*w41^2*sind(T41-T31);
H2 = c*w42^2*sind(T42 - T32);
I1 = 2*Vs1*w41;
I2 = 2*Vs2*w42;
J1 = b1 + c*cosd(T31- T41);
J2 = b2 + c*cosd(T32- T42);
a41 = (F1 + G1 + H1 - I1)/ (J1);
a42 = (F2 + G2 + H2 - I2)/ (J2);
K1 = a*w2^2*(b1*cosd(T31-T2) + c*cosd(T41 - T2));
K2 = a*w2^2*(b2*cosd(T32-T2) + c*cosd(T42 - T2));
L1 = a*a2*(b1*sind(T2 - T31) - c*sind(T41 - T2));
L2 = a*a2*(b2*sind(T2 - T32) - c*sind(T42 - T2));
M1 = -w41^2*(b1^2 + c^2 +2*b1*c*cosd(T41 - T31));
M2 = -w42^2*(b2^2 + c^2 +2*b2*c*cosd(T42 - T32));
N1 = 2*Vs1*c*w41*sind(T41 - T31);
N2 = 2*Vs2*c*w42*sind(T42 - T32);
As1 = -(K1 + L1 + M1 + N1) / (J1);
As2 = -(K2 + L2 + M2 + N2) / (J2);
Aa = (-a*a2*sind(T2) - a*w2^2*cosd(T2)) + 1i*(a*a2*cosd(T2) - a*w2^2*sind(T2));
Aam = abs(Aa);
TAa = radtodeg(angle(Aa));
Ab1 = (-c*a41*sind(T41) - c*w41^2*cosd(T41)) + 1i*(c*a41*cosd(T41) - c*w41^2*sind(T41));
Ab2 = (-c*a42*sind(T42) - c*w42^2*cosd(T42)) + 1i*(c*a42*cosd(T42) - c*w42^2*sind(T42));
Ab1m = abs(Ab1);
Ab2m = abs(Ab2);
TAb1 = radtodeg(angle(Ab1));
TAb2 = radtodeg(angle(Ab2));
